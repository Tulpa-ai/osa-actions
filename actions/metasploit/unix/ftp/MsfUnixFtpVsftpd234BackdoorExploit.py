# USER EDITABLE FILE.
# This file extends the autogenerated base class.
# Please add your customizations here. Do NOT modify the base class.
from builtin_actions.metasploit.unix.ftp.MsfUnixFtpVsftpd234BackdoorExploitBase import MsfUnixFtpVsftpd234BackdoorExploitBase
from artefacts.ArtefactManager import ArtefactManager
from kg_api import Pattern
from Session import SessionManager
from action_state_interface.exec import ActionExecutionError, ActionExecutionResult

class MsfUnixFtpVsftpd234BackdoorExploit(MsfUnixFtpVsftpd234BackdoorExploitBase):
    def __init__(self):
        super().__init__()
        
    def function(self, sessions: SessionManager, artefacts: ArtefactManager, pattern: Pattern) -> ActionExecutionResult:
        # For some reason this exploit often needs running twice to work
        try:
            res = super().function(sessions, artefacts, pattern)
        except ActionExecutionError:
            res = super().function(sessions, artefacts, pattern)
            
        return res
